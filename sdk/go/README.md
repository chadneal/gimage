# Gimage Go SDK

Type-safe Go client for the Gimage API, generated from OpenAPI spec v1.2.64.

## Features

- üîí **Type-safe**: All request/response types generated from OpenAPI spec
- üöÄ **Easy to use**: Simple, idiomatic Go API
- üîë **Authentication**: Built-in support for API Gateway API keys
- üìù **Well-documented**: Complete examples and godoc comments
- ‚úÖ **Production-ready**: Generated by industry-standard oapi-codegen

## Installation

```bash
go get github.com/apresai/gimage/sdk/go
```

## Quick Start

### Basic Usage

```go
package main

import (
	"context"
	"fmt"
	"log"

	gimage "github.com/apresai/gimage/sdk/go"
)

func main() {
	// Create client
	client, err := gimage.NewClient("https://your-api.execute-api.us-east-1.amazonaws.com/prod")
	if err != nil {
		log.Fatal(err)
	}

	// Generate image
	ctx := context.Background()
	resp, err := client.GenerateImage(ctx, gimage.GenerateImageJSONRequestBody{
		Prompt: "sunset over mountains",
	})
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()

	fmt.Printf("Image generated! Status: %d\n", resp.StatusCode)
}
```

### With API Key Authentication

```go
package main

import (
	"context"
	"fmt"
	"log"
	"net/http"

	gimage "github.com/apresai/gimage/sdk/go"
)

func main() {
	apiKey := "your-api-key-here"

	// Create client with API key
	client, err := gimage.NewClient(
		"https://your-api.execute-api.us-east-1.amazonaws.com/prod",
		gimage.WithRequestEditorFn(func(ctx context.Context, req *http.Request) error {
			req.Header.Set("x-api-key", apiKey)
			return nil
		}),
	)
	if err != nil {
		log.Fatal(err)
	}

	ctx := context.Background()

	// Generate image with custom options
	resp, err := client.GenerateImage(ctx, gimage.GenerateImageJSONRequestBody{
		Prompt:         "futuristic city with flying cars",
		Model:          stringPtr("gemini-2.5-flash-image"),
		Size:           stringPtr("1024x1024"),
		Style:          (*gimage.ImageStyle)(stringPtr("photorealistic")),
		NegativePrompt: stringPtr("people, text"),
		Seed:           intPtr(42),
		ResponseFormat: (*gimage.ResponseFormat)(stringPtr("base64")),
	})
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()

	fmt.Printf("Status: %d\n", resp.StatusCode)
}

func stringPtr(s string) *string { return &s }
func intPtr(i int) *int          { return &i }
```

### Image Processing

```go
// Resize image
resp, err := client.ResizeImage(ctx, gimage.ResizeImageJSONRequestBody{
	Image:  "base64-encoded-image-data",
	Width:  1024,
	Height: 768,
})

// Crop image
resp, err := client.CropImage(ctx, gimage.CropImageJSONRequestBody{
	Image:  "base64-encoded-image-data",
	X:      100,
	Y:      100,
	Width:  512,
	Height: 512,
})

// Convert format
resp, err := client.ConvertImage(ctx, gimage.ConvertImageJSONRequestBody{
	Image:  "base64-encoded-image-data",
	Format: gimage.ImageFormatWebp,
})
```

### Health Check

```go
resp, err := client.HealthCheck(ctx)
if err != nil {
	log.Fatal(err)
}
defer resp.Body.Close()

if resp.StatusCode == 200 {
	fmt.Println("API is healthy!")
}
```

## Available Operations

### Image Generation
- `GenerateImage(ctx, request)` - Generate image from text prompt

### Image Processing
- `ResizeImage(ctx, request)` - Resize image to specific dimensions
- `ScaleImage(ctx, request)` - Scale image by factor
- `CropImage(ctx, request)` - Crop image to region
- `CompressImage(ctx, request)` - Compress image quality
- `ConvertImage(ctx, request)` - Convert image format

### Batch Operations
- `BatchResize(ctx, request)` - Resize multiple images
- `BatchCompress(ctx, request)` - Compress multiple images
- `BatchConvert(ctx, request)` - Convert multiple images

### Utility
- `HealthCheck(ctx)` - Check API health
- `ListModels(ctx)` - List available AI models

## Type Safety

All request and response types are generated from the OpenAPI spec:

```go
type GenerateImageJSONRequestBody struct {
	Prompt         string           `json:"prompt"`
	Model          *string          `json:"model,omitempty"`
	Size           *string          `json:"size,omitempty"`
	Style          *ImageStyle      `json:"style,omitempty"`
	NegativePrompt *string          `json:"negative_prompt,omitempty"`
	Seed           *int             `json:"seed,omitempty"`
	ResponseFormat *ResponseFormat  `json:"response_format,omitempty"`
}

type ImageStyle string
const (
	ImageStylePhotorealistic ImageStyle = "photorealistic"
	ImageStyleArtistic      ImageStyle = "artistic"
	ImageStyleAnime         ImageStyle = "anime"
)

type ResponseFormat string
const (
	ResponseFormatBase64 ResponseFormat = "base64"
	ResponseFormatS3Url  ResponseFormat = "s3_url"
)
```

## Error Handling

```go
resp, err := client.GenerateImage(ctx, request)
if err != nil {
	log.Fatalf("Request failed: %v", err)
}
defer resp.Body.Close()

if resp.StatusCode != 200 {
	body, _ := io.ReadAll(resp.Body)
	log.Fatalf("API error: %s", body)
}
```

## Advanced Usage

### Custom HTTP Client

```go
httpClient := &http.Client{
	Timeout: 30 * time.Second,
}

client, err := gimage.NewClient(
	baseURL,
	gimage.WithHTTPClient(httpClient),
)
```

### Request Middleware

```go
// Add custom headers or authentication
client, err := gimage.NewClient(
	baseURL,
	gimage.WithRequestEditorFn(func(ctx context.Context, req *http.Request) error {
		req.Header.Set("x-api-key", apiKey)
		req.Header.Set("x-request-id", uuid.New().String())
		return nil
	}),
)
```

## Documentation

- **Full API Reference**: See [openapi.yaml](../../openapi.yaml)
- **Examples**: See [example_test.go](./example_test.go)
- **Generated Types**: See [types.gen.go](./types.gen.go)
- **Client Methods**: See [client.gen.go](./client.gen.go)

## Regenerating

To regenerate the SDK after updating `openapi.yaml`:

```bash
cd /path/to/gimage
make generate-sdk
```

## License

MIT - See [LICENSE](../../LICENSE) for details.
